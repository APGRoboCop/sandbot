
Based heavily on code written by Jeffrey "botman" Broome.